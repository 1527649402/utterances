{"version":3,"sources":["deparam.ts","repo-regex.ts","page-attributes.ts","utterances-api.ts","oauth.ts","encoding.ts","github.ts","time-ago.ts","comment-component.ts","bus.ts","timeline-component.ts","new-comment-component.ts","utterances.ts"],"names":[],"mappings":";;;;;AAAA,SAAA,OAAA,CAAwB,KAAxB,EAAqC;AACnC,ACDF,QDCM,ACDN,KDCE,ECDF,GAAe,6BAAf;ADEE,QAAM,OAAO,KAAb;AACA,QAAM,SAAS,oBAAf;AACA,QAAM,SAAS,SAAT,MAAS,CAAC,CAAD,EAAU;AAAK,AGHnB,QAAA,OHGmB,OGHnB,GAAiB,SHGqB,EAAE,OAAF,CAAU,IAAV,EAAgB,GAAhB,CAAnB,CAAA,eGHnB;AHG2D,AEJxE,IAAA,CFIE,WEJF,QAAA,WAAA,CAAA;AFKE,AILF,AFCA,IEDA,AFCA,IFIQ,SAAsC,EAA5C,AEJF,IEDA,QAAA,IFCA,QAAA,MEDA,CAAA,OFCA,CAAA,CAAA;AFME,AINF,AFEA,IEFA,KFEA,EFIS,KINT,GJMiB,KINjB,EJMwB,CEJxB,GFIiB,AEJjB,CFI6B,IIN7B,CJMiB,AINjB,CJME,EAAmC;AACjC,AKNJ,ADCA,AFCE,IEDI,IFCE,CGFR,MLMW,EEJM,EEDO,GJKN,GKNlB,CAAiC,CHEhB,CFIO,CAAN,CAAP,CAAP,EKNJ,CHEiB,CFIc,AKNiB,AHEvB,CEDD,MJKc,EEJJ,IFIU,CAAN,CAAP,AILP,AFCC,CFIrB,AEJqC,EEDH,IFCb,CAAuB,CAAvB,CAAR,CAAf,IEDF;AJMG,AKND,ADCF,AFEE,IEFI,IFEA,MGHM,CDCQ,KFEa,EGHb,EHGlB,KGHU,CAAgB,EDCR,GCDR,EAAuB,EAAvB,CAAV,MDCkB,GAAc,QAAlC;AJME,AKNA,ACJF,AFMA,AFCE,IIPF,AFMM,IFCA,GFGG,AKNA,GCJT,GNUE,EIJsB,GENxB,AJOmC,IAAjC,EED+B,ECFL,CCJ5B,CAAA,EFMwB,GCFW,ADEI,KCFC,OAAL,CAAP,CAAnB,CAAP,GDEF;AJKC,AKNA,ACJD,AFOA,AFAE,IIPF,AFOA,IFAM,IEAN,KEPA,OFOA,AFAsB,CIPtB,KJOE,EAA4B,KIP9B,CAAA;ANDA,AKEA,ACAA,AFUE,AFHE,AKPJ,IDAA,ACAM,IPFN,AKEA,KDUE,EJZF,EOEmB,CPFnB,AIYE,AGTA,ELMc,CEGd,CGViB,CDAnB,CDAA,AECQ,CPHR,EKEA,AHOuB,IIPvB,CCAmB,EAEjB,KLKc,CAAZ,CKLK,EFFT,AEAmB,EAEN,IDFb,CAAA,GCAmB,EAGjB,OAAO,EAAP,GAAY,EAHK,EAGD,MAHC,EAIjB,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAJA,EAII,KAJJ,EAKjB,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,CALL,EAKQ,MALR,EAMjB,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,EANL,EAMS,OANT,CAAnB;APWA,AMTA,AFKmB,AFCf,AKCJ,IDPM,ACOA,KPEN,GEHQ,CEDW,CJInB,CAAsB,EMTH,CNSnB,EAA8B,AOFoB,EAAE,CHFjC,GAAa,AFCV,GKCqC,MLDvD,CKC8C,CLDjB,CKCmC,EHFjD,EELnB,CCOyE,SAAvB,EAAkC,MAAM,SAAxC,EAAlD;ACVA,ARaE,AMTF,AFKU,AFCJ,AKEN,ICZA,AFIM,INSE,CODR,IHHU,GJIM,AEHN,AKEV,CCZA,ADYwB,CPCtB,AIJQ,GAAuB,GGGjC,CCZA,AJSU,CGG+B,ILFjB,CKExB,CLFM,CIN6B,ACQiB,CLFxB,GMV5B,CAAA,qCFIA;AEFA,ARYE,AMTF,AFOI,AFDI,AKEN,ICXI,AFGA,ICQE,CPCD,GIFC,CJEK,IQZM,ARYjB,CODgB,GPCG,CEHP,EFGZ,EAAwB,AEHR,EMTlB,AFG8B,ACQF,GLFd,CAAU,EKEU,OAAN,EAA1B,sBDRF,kBJMc,CAAN;AOPR,ADDA,ARYI,AMTJ,AFOM,AFDC,AKEL,IEVE,ADDE,AFGA,ICQA,IPCE,ESXR,ETWY,CIFD,CGCK,IHDV,AGCJ,EAAoB,CHDH,CIV6C,IRYxD,CAAmB,IAAnB,CAAJ,EAA8B,AIFF,GEPW,IFOxB,CAAqB,KAAK,UAA1B,CAAb,yBEPN;AGAA,ADFE,ARYI,AMTN,AFQK,AFFC,AKEF,IDRE,KGDN,ALMI,CAGE,KGAK,CDRO,AJMR,CEEG,AFFF,CMTK,ARYJ,AIDN,CERN,CFQgB,CAAG,CKTnB,ATUM,CSVwB,ATUV,CEHV,CKEN,CLFgB,GOPpB,EAA4C,APOlC,CMVsD,CNUrC,SFGY,CEH7B,EAA6B,CFGnB,IAAwB,EEHlC,CFGU,AEH2B,GFGC,MEHtC,MAAoD,CAAC,CAAzD,EAA4D,GFGC,IAAI,IAAJ,CAAnB,CAA1C;ASTJ,ADFA,ARYG,AMRL,AFOG,AFFK,AKEL,AGhBH,IJSI,AITJ,KJSA,QGFe,ADFA,MCEb,GCPF,ERcoB,EMX4C,IEHhE,CRc2B,SAAP,CAAZ,UQdR,CAAA;ADQE,ADFA,ARYC,AMRH,AFQE,AFHK,AKEL,AGhBF,IJSI,AITJ,IJSA,ACOM,GHCJ,CIZQ,ADWA,AGhBV,CHgBE,OCd8D,AEFhE,CDOmB,ILUjB,CAAI,CMjBN,CAAA,CDOE,EAA2B,CLUvB,SAAJ,EAAI,CKVJ,MLUA,EAAS;AKTV,ADFC,ARYA,AMRF,AKZA,ATiBK,AKEH,AGfF,IJQI,AKZJ,ADIA,MJQA,CEJS,ARYA,AODA,EHAP,EOnBF,AJmBa,CAAJ,CPCM,EODE,EPCR,CAAW,CWpBpB,CDIA,CVgBS,CAAP,EIDA,EGA0B,GInB5B,CAAA,EJmBS,AGfT,IHesC,UAAU,GAAV,GAAgB,WAAW,IAAI,CAAf,CAApD,EAAuE;AEZzE,ADHgE,ARiB/D,AMPD,AKbA,APmBI,AFFD,AKEC,AGTF,CFPF,GGHA,CTOE,GODF,CHOA,EJIS,CSjBT,CJmBS,AGTP,CHSE,CLFS,IEEF,COnBX,CFMA,EHOA,CGPA,AHO+B,AFMf,GOnBhB,CAAA,CPmBI,CMTF,CJGF,AIFY,EJE4E,AJIzD,EQP7B,EDJF,ACMY,ERKH,EAA8B,CQPrC,EAE6B;ADD/B,ADDA,AREA,AMEE,AKXF,APiBG,AFFC,AKED,AGTS,AEZZ,IHYI,ADDJ,AGPM,ACJN,IZaA,CIMW,GEJD,CNFV,AUDY,GVCZ,CSDiB,ACAL,CDAM,CAAlB,CHGkB,AIHN,CVCZ,CWTwB,ATeN,CMRlB,ANQmB,CQPP,AEZZ,CNeE,KJIwB,EUnB1B,GJWA,SNQmB,CAAf,MUnBJ,CAAA,kXDIA;AFUA,ADAE,AFEA,AKVF,ATcI,AKGF,AGVU,AEZZ,IDKM,ACLN,ILsBQ,CETR,EHES,CJID,CMNN,AJQA,AMTU,EEZZ,GLsBkB,AGVN,CJGK,EIHL,CDCZ,CHEE,AMfF,CVmBoB,CONpB,AER2B,CPgBf,AMTA,GFCV,ADS2B,CCRlB,ADQO,CAAhB,CLHM,CAAqB,AUnB7B,CRqBE,AQrBF,CVmBQ,CEEY,CIRlB,EAEU,ENIyB,OAAO,EMN1C,EAEoC,IGVkB,KAAK,CTcxB,CAAjC,EAAyD,WSdL,CAAxD;AFSE,ADAS,AFET,AKTF,APeI,AFFE,AKGJ,AGlBiB,AEOnB,IDLM,ACKN,IHEQ,AFSA,KCTG,AFEA,AIXQ,CEOnB,CLWe,EETE,ALQR,CFFG,EMND,CFEQ,AIXA,CNiBf,AFFY,AURhB,CJEW,AGPc,CDFyB,CNiBjC,CKRS,AFSA,AGlBP,CJWjB,AJIU,CAAU,EONL,ADAN,ADSmB,CETC,AFShB,AKXf,CLWE,AKXF,CRUI,UKRF,AEPF,iBTamD,OAAO,cAAP,CAAvC,CAAN;AOLJ,ADAU,AFEX,AKRD,APcI,AFFC,AKGH,AGhBQ,AEKV,IDJA,ACIA,IHEM,AFSE,KCTI,AEPF,GNeF,AGCQ,EGhBN,CDOO,EFSI,AGhBK,CAAhB,EFOE,EGNZ,AJegB,CCTJ,ADSe,AKX3B,EHEE,EAA2B,IGF7B,ELWqC,CCTzB,AGNZ,MJegB,CAAd,YKXF,CAAA;AHGI,ADCQ,AFJZ,AKSE,APEI,AFFH,AKID,AGZE,AEAJ,IAAA,CVGS,GIJT,ACaM,GLJG,CMLG,CGKV,ADRO,GHYK,CAAR,ECTM,CJOF,AMVN,CHYe,CDbnB,CICmB,EJDnB,EEIY,ADSa,GKZzB,CJGY,CGKV,ADR0B,CCShB,APCW,IOFrB,APEI,CGE8B,AKZpC,CNDA,AKWqB,APAQ,KGEJ,CIJvB,ADRiB,CAAuB,CCUsB,AJEnB,CAA3C,EAA8C,KGZ7B,CAAf,OEAJ,CAAA;AHGG,ADAS,AFEZ,AKGE,APGM,AFFJ,AKIA,AGZA,AEAJ,IAAA,KNIA,GEFkB,AGKhB,ACPF,CFAS,CRQC,CKIC,GLJG,ESDZ,ADPE,AEAJ,CFAiB,CJIjB,CEFkB,AFEK,AJIb,AKIO,CILf,ATCkB,GURpB,CAAA,CLYuB,CGZnB,CFEc,AEFS,ENUN,CENrB,AIJI,CAA2B,CJIa,GEFhC,CFEZ,EAA8D,CFMtD,CAAwB,CMV5B,EHYa,CAAyB,CHFL,QGEpB,EHFT,AGE6C,aAApC,CAAb,ELJM,CAAN;AOLF,ADDU,AFGV,AKGU,APGL,AFFJ,AKIA,AGZC,AECJ,SAAA,ENGS,CEHmB,CGMhB,ADPH,IDEM,AEKH,APCN,EEJW,CKGL,ADPR,CJIF,AIJe,EDEf,ALQW,AQTb,CDMY,ACNG,CJAa,KEDxB,GFCwB,AEDC,SECd,CJAH,aIAZ,2OFDI;ADGF,ADFU,AFIV,AKGmB,APGb,AFDN,AKGA,AGLE,AELJ,QHAQ,APOF,CILC,AMFP,CVOQ,CKGC,CCZ+B,CFItC,AKGmB,ADAZ,GJHK,EGFmB,AGAjC,CDKqB,CFLc,APOjB,CKGC,AKVnB,CNEE,AKGmB,AJKZ,ECZ+B,AEOpC,CHKmB,CEVkB,APOnC,AKGoB,CLHxB,AQFqB,CCAF,CTEM,GMTa,AEOZ,CNGP,CKRY,CFUE,CEVgB,GCK5B,CNGf,AMH4B,CFPxB,AJUiB,AGEH,GEV+B,AFUb,EHFV,EGER,EEVO,CFUkB,CEVjD,EFUqB,EHFf,CMHe,CNGuB,AGEQ,AGLC,GHKhC,GAAmC,EHFlD,EGEe,GAAuC,IGL1D,EHKK,GAAiE,QAAK,GAAL,GAAS,IAAT,GAAa,OAArF;AETA,ADHU,AFKV,AKHQ,APSH,AFDH,AKGH,AGLG,AELF,QAAI,CNEC,EGFE,CDH0C,CGEzC,ADMD,CJHP,AJKQ,GILK,CJKD,CQFV,GDLF,ACKgB,CDLG,AEDX,ATQA,CAAU,ESRG,ACCjB,CNEJ,GGFA,CEDQ,ADMiB,CDLG,CDHqB,OIG7C,CJH6C,AIGxC,CHAT,ECKgB,CRER,AQF+B,CRErC,MUPE,CFKY,CAAd,GELuB,EJHf,EIGV,EAA+B;AHChC,ADHG,AFKF,AKHQ,APUL,AFFF,AKhBH,AGcI,AELA,QNEI,ACXR,KCMS,AGEC,APGN,AMGK,CNIH,CGlBN,AKSW,GNEO,ACXlB,ECMI,AEQA,CNIS,AMJI,CJHK,AFOhB,CIZa,CJYH,AQTL,CRSQ,AGlBnB,CIQU,GLGQ,AKHQ,CLGI,AKHpB,EHFkB,AEQxB,CAAyB,KAAK,GELvB,CAAkB,CNEc,CIGvC,CFRe,CAAuB,QFKxB,CELC,CAAf,AFKoD,IAAtC,AMFW,CNE3B,aMF2B,CAAK,WAAvB,CAAP;AHRJ,ADMI,AFKF,AKyEQ,APlEP,AFDD,AQHE,AELD,QHTH,APiBM,CEZK,CFYH,EINE,CELD,AG8EC,ADtED,MJHP,CELE,AFKc,CGXlB,ADMiB,AEQb,CRGgB,AQHF,CJHhB,CGXF,AHWsB,AKyEZ,GAAc,ADtED,CRGjB,CAAJ,CMXE,CAAuB,ANWE,CIN3B,AIGE,EFRA,AFK4B,CELD,ECN/B,EEoFwB,cH9EpB,eFKF;AEJE,AFKF,AKyEE,ATnEA,AQHA,AELF,QNEI,CAAC,EMFE,CJHD,CEQC,CRGC,ESmEA,CH9EG,CNWC,EURL,CNEU,CELX,CG8ES,ATnEP,CEbC,AFaS,AQHhB,CJHG,CAAiB,CELD,EG8ED,MC3Eb,CAAgB,CNElB,AKyEU,CH9Eb,AFKE,AKyEyB,EH9EK,EFKI,CKyEpC,ITnEM,CAAN,EINoC,IMFf,CNEe,CAAM,KAAN,KAAgB,EMF/B,CAAK,CNE5B,EAA4D,MMFrD,CAAP;AJFI,AFKF,AKyEA,ATnED,AQHA,AELF,gBNEW,AKyEF,CH9EC,MFKP,CELE,AFKc,CELD,EFKf,CAAoB,GKyEC,GH9EnB,CAAuB,GAAvB,CAA2B,AG8EA,ILzE7B,AKyEqB,CAAa,CLzEG,GKyEhB,CAArB,IH9EE,GFK4C,QAAA,KAAA,CAAM,KAApD;AEJC,AFKF,AKyEC,APlFO,AFgBT,AQHO,AELT,KRRE,GFgBM,AURA,GAAR,CAAY,CAAC,KD0EJ,ATlES,IQHT,EELG,EAAc,ID0EtB,CAAkB,ATlEJ,AQHT,CAAA,GELiB,GVQR,CSkEd,ATlEwB,AQHnB,GCqEwB,ADrE/B,CRGgB,AURQ,CVQO,CURrB,CAAZ,EACG,GVOqC,CQHvB,AELjB,CACQ,CDyEJ,CTlEc,CAAhB,AQHA,EAAgC,KEJzB,EAAD,EAAc;AJJlB,AFKF,AKyEE,APrEJ,AFGE,AQHE,QRGE,AURI,GNCD,AFIT,CITU,CESD,GCqED,APrER,AQLU,CFKN,CJJF,CMDQ,CVQQ,AQHF,AELN,ED0EG,ETlEX,AQHE,EFToB,ANYA,ISkEhB,CAAc,YAAd,GH9EoC,AG8EP,GAA7B,IAAoC,MAAK,KH9EzB,CAApB,EG8EwC,CAAc,YAAd,GAA6B,MAAK,QAAL,CAAc,YAAnF,EAAiG;AH7EjG,AFKH,AKyEK,AP/FN,AF6BI,AQHA,CN1BJ,EAAA,KQoBiB,IFMP,CFTD,CNYC,CUTO,GVSH,AUTG,CAAA,CJHb,AESc,CFTD,CG8EN,CTlED,CAAU,GQHK,GFTrB,AG8EE,CAAc,CDrEU,CFTD,GG8EvB,CAAoB,ADrER,GAAoB,GCqEhC,CDrEF,CRGkC,CSkEA,MAAK,ATlEE,IAAzB,GAA6B,CSkEX,CAAc,ETlE1C,CAAN,SMX4B,AG6EM,GAA0B,EH7E3B,EG6E/B,MH9EuB,GACgB,6CADhB,GAER,KAAK,KAFG,GAEE,qDAFF,GAGR,KAAK,UAHG,GAGU,UAHV,GAGoB,gLAHpB,GAQY,KAAK,QARjB,GAQyB,+BARzB,GAQsD,KAAK,KAR3D,GAQgE,kFARhE,GAUY,QAVZ,GAUoB,uBAVpB,GAUyC,WAAA,OAAA,CAAQ,KAAK,GAAL,EAAR,EAAoB,IAAI,IAAJ,CAAS,UAAT,CAApB,CAVzC,GAUkF,qCAVlF,IAYjB,cAAc,8CAA0C,WAA1C,GAAqD,SAAnE,GAA+E,EAZ9D,IAYgE,iGAZhE,GAejB,SAfiB,GAeR,gCAfjB;AAmBA,AFZJ,AKwEM,APrEO,AFGV,AQHC,AEPuB,INIrB,IFGO,GQPc,EJgBlB,AJTI,AMAJ,GJHS,AFGG,CMAR,GNAY,CMAR,AEPoB,CD4E/B,ADrEF,EAAgB,CNAC,CISjB,AIhBuB,CROd,CMAW,AEPoB,IAAjB,CFOE,AEPF,ED4ErB,MDrEkB,CAAc,MAAlC,EAA0C,GAA1C,EAA+C;AFUhD,AFZD,AKwEG,APpEL,AFGE,AQJI,AER2C,CADjD,QRUA,EFGS,GIPG,AFIZ,GAAA,AMDW,QAAL,CAAc,CAAd,EAAiB,cAAjB,CAAgC,KAAhC;AFWG,AFbL,AKyEA,APrEF,AFGE,AQJC,AEPL,SAAA,ERQS,IEJE,AFIT,AFGS,CEHM,EQRjB,CAAmB,EJiBV,CFbS,CJOC,CAAR,AUXX,CD6EiB,ATnER,CUV+B,IJiB/B,AIjBT,CJiBS,AFdG,AK0EU,APrEO,CQR4B,ERQxC,GAAgB,OOqE7B,CH5DK,EJTwB,CIS/B,IJT+B,CAAM,EAAE,GISjB,WAAtB,AJTmD,EISH,UJTX,EAAN,CAA/B;AIUE,AFbA,AKyEA,APrEF,AFGE,AQJA,AEPF,UAAA,CRQO,CISD,ENNE,AQJN,CNCS,COqEL,CH5DK,EFbE,GFIN,AFGS,CEHG,AFGX,AUXR,CVSO,AUTO,ENIM,CIGlB,CFUI,AG4DJ,EAAkB,GH5DO,AJTR,EENT,KFMS,EAAO,AQRZ,EJiBZ,EAAsC,UIjB1B,CAAK,MAAnB;AJkBI,AFbF,AKyEE,APtE0B,AFI5B,AQJD,AEND,KFDO,GECD,ONGG,AFGsB,CFIrB,GUVO,GD4ER,APtEqC,CQNzB,KVUC,CSkElB,CAAa,ITlEP,GAAqB,CEJA,GOsE3B,APtE6D,GOsElC,ATlEO,AUVjB,IRMS,EFIpB,GAAqC,OSkE3C,CTrEG,AUPU,CAAsB,IAAtB,EAA4B,KAA5B,CAAjB;AJiBG,AFjBO,AK6EP,APvEqE,AFKtE,AQHK,AEPP,KNFgB,AFOT,EACJ,IADI,CACC,COoEN,AC1EO,IAAT,CAAc,CD4EL,CTlEK,EEJN,AMCD,MNDC,CQNR,CRMc,AQNY,CFOnB,CAAA,KRGwB,EUVI,CFO5B,GRGO,AQHd,GRGwC,AUVxC,OVU+C,AQH/B,KAAhB,EAAmC,MRGK,CAA1B,GAAkD,iBAJzD;AMWL,AFbF,AKyEI,APvEc,AFKhB,AQHA,AENF,QAAI,INEI,CEaD,AETA,ENFW,EQJL,CFMX,CRGS,EELa,AMET,CCqEN,CC3EU,CJejB,EETA,CFSmB,CNXd,CSuEH,CAAa,CC3EJ,CRIsB,EQJL,CAA9B,EAAiC,CJe/B,AJXgB,EAAyB,COuEvC,CPvEyC,EOuEd,IPvEoB,MAAR,EAAzB,CAAA,OOuEd;AH1DF,AFdA,AKyEE,APxEwD,AFM1D,AQHA,AENA,KREK,EAEJ,IAFI,CIcD,AJZE,AMEF,GJJG,EEcE,AEVT,AENA,EFMW,ERGA,CIPG,AKyEP,APvED,EIYF,CAAa,IAAb,CAAkB,AJZhB,CEHA,CFGQ,AFDT,CUHL,CAAiB,CJgBb,AG2DF,GAAqB,EH3DS,AIhBT,KJgBc,CIhBrC,EAA+B,CD4E3B,AC5EJ,EACG,IADH,CJgBA,AIfQ,EJe0C,GG4D9C,KC3EK,EAAD,EAAU;AJgBhB,AFdF,AKyEU,APvER,AFKF,AQHE,YNFI,IFKE,AUTG,CJgBJ,AEVA,EJJI,EFEI,EAAb,AFKa,CMOb,AIhBS,CJgBI,AJZI,CEFD,CKyER,AC3EC,CFMT,CRJG,AQIc,IAAjB,CFUA,CAAuB,AFhBnB,CK2EI,ADrEgB,EFUxB,CAA2B,GEVG,QCqEtB,ADrER,CCqEuB,EH3DvB,EG2DQ,EAAqB,IAArB,CAA0B,UAAA,IAAA,EAAI;AH1DvC,AFdD,AKwE4C,APtExC,AFKJ,AQHC,AEPsB,SJevB,AEVA,IRKK,EMOE,AFdA,AIIA,INFI,AQLY,CVUX,GARP,EUFwB,GRKT,GOsEwB,CPtEjC,AQLY,CAAc,CRKjC,GOsE6C,MC3EZ,CD2EO,CAAa,KC3EpB,EAAO,ED2EA,GAAyB,IAAzB;AHzD1C,AFlBI,AK2EmE,APrEtE,AFKH,AQHE,AER8C,eVWzC,EMOA,AEVA,ICmEG,CThEI,CSgE6D,AC3E3B,CJkB9C,CAAa,EGyDL,ATzEL,CSyE2E,ADnE9E,CAAiB,GERsC,EJkBvD,AGyD8E,CHzDvD,MAAvB,CAA8B,EEV9B,CAAiC,AERa,CAAuB,CD2E7D,CAAA,GDnER,EER8C,CAAA,EJkB9C;AACD,AFzBa,AKiFgF,APpE5F,AFKF,AQHC,AET8E,CNNnF,YMM2B,CAAA,CROd,EOmEc,EAEnB,EThES,CS8DU,CAArB,CPnEgB,IAAT,AFKW,GELK,IAAhB,CAAqB,UAAA,IAAA,EAAI;AIanC,AFbH,AKsEK,APtEqC,AFLjC,AQQN,AEViF,KJS3E,ANPP,AQCO,IJIT,AMRI,URQsC,MEA1C,CAA0B,CFAwB,MAAR,CEA1C,AFAyD,EEAb,4BFAyC,IAA3C,CAAA;AIehC,AFdR,AKsEC,APvEyF,AFO3F,AQFQ,AEXN,QNOK,CKoDE,APrDG,CAAP,MECU,KEcN,CEVD,GJJgB,KEcf,CAAA,AEVD,CJJO,AIIP,CJJwB,GAAjB,CAAqB,OEc3B,CEVD,EFUP,CEVA,QJJc,CAAd,CIIqB,CFUrB,MEVA,EAA0C;AFWxC,AFdF,AKuEQ,APxEL,AFQQ,AQHT,AEVF,KRFO,EAQJ,CEAG,AJOK,AUbP,GRFG,CIsBC,AJdA,AMIA,CCmEA,IC7EK,GJoBG,AFdE,EFAV,AFOG,CEPH,AQNW,CFUC,CFUC,AGyDb,APvEC,AFOmB,GSgEL,ADnEC,CJJG,AMN3B,EAA2B,CJoBX,CAAa,GFdX,CAAiB,CKuEX,ELvEN,CAAqB,EKuEhB,EAAa,AThEzB,GQHa,CFUR,CAA+B,cFd7B,AIIE,CJJpB,AIKI,CFSY,CAAiD,KEV7C,EAEhB,KAAK,IFQO,AERZ,CFQ8E,EERlE,CFQA,CAAd,GERmB,IAAL,CAAU,KAAtB,GAA8B,IAFd,CAAlB;AFWA,AFdF,AKuEE,APxEa,AMOb,AEZA,QNMI,IEcA,CERC,GFQG,AFdI,AFDC,EOwEP,GPxEO,AMOb,CFQc,AJfK,AMOL,GJNO,CIMrB,CNPa,AMOM,CFQnB,EJf2B,CAAd,CECD,AKuEZ,CLvE6B,GAAjB,AIMZ,CJNiC,mBAArB,CAAd;AEeE,AFbF,AKsEE,APzE+B,AMQ/B,AEZD,KRJM,EAQ4B,CEG7B,KIKC,EFQE,CGyDH,CPzE6B,CIgBjC,CFbe,CEaH,AERZ,CAAa,CCiEJ,CPzEwB,EAAM,OEGX,AKsE5B,CDjEA,CCiEqB,ADjEK,EJLX,CAAkB,OIKG,EJLM,GAA3B,CAAjB,CIKE,EAA6C,KAAK,MAAlD;AFSE,AFbJ,AKsEI,AP1E2C,AMS7C,AEXF,QNMM,AMNA,KFWC,EJLM,CEaH,AJjBqC,CQFhC,CFWb,GNT6C,CAAM,CIiBpC,GFbO,AMNlB,CREyC,EIiBxB,CJjBsC,EQF9C,CJmBE,AInBD,CJmBY,AJjBmB,CIiB9B,AJjBkD,CIiB/D,AFb8B,KFJuC,AQF1D,CNMF,CMNmB,ENMW,EFJwB,QEId,QAArD;AEcI,AFZJ,AKqEG,AP3E+E,AMUhF,AEXA,KRPK,CAAP,GEcK,GMPC,CFWC,CJJP,EMPE,CJmBO,AFZI,CAAC,AMPF,KJmBR,AFZJ,CIIE,EFQgB,QAAd;AACD,AFZH,AKqEE,AP3EH,AMUG,AEXE,SNOC,KIIH,EEXM,ENOR,AKqEO,GLrEU,CAAC,KIIhB,CCiEA,GLrEF,AKqEoB,EC5EE,ED4EpB,GC5EoB,CAAlB;AJoBH,AFZD,AKqEE,APvFJ,AMsBG,AEXG,KJYI,AEVD,GNbT,CEkBO,IFlBP,CEkBE,EKqEM,APvFR,AQWU,CNOK,CAAC,GFlBhB,AQWM,CD4EO,CLrEX,AMPe,GD4Eb,EAAe;AHxDnB,AFXE,AKoEI,ADhEI,AEZF,QNQF,GEWN,MFXe,KKoEJ,ADhED,CJJJ,IEWN,CFX0B,EKoEpB,CLpEA,AKoEc,ADhEV,CAAA,CEZe,ENQQ,IKoE3B,CLpEgC,EKoEP,AC5EN,CFYf,GCgEJ,ADhEJ,GJJ+B,IMRR,CNQ2B,AMRf,CNQnC,EAAqD,CIIrD,EEZyC,MAAlB,EAA0B,QAA1B,CAAjB;AJtCR,AF+CI,AKoEE,ADhEF,AEZG,CJvCP,EAAA,SF+CU,CIID,AEdH,MAEO,GD4EF,ELpEW,AIIlB,CAAiB,GJJK,IAAJ,CAAS,CAAT,AKoEhB,CLpEF,AKoEoB,CDhEpB,GAAkC,ICgEhC,CDhEqC,ECgER,GDhEG,CCgEhC,EDhE0C,UAAV,IAAqB,KAAK,KAAL,KAAe,CAAf,GAAmB,EAAnB,GAAwB,GAA7C,CAAlC;AFnDS,AFgDT,AKoEC,ADhEF,AEZK,KFUE,GFlDG,UFgDC,MEhDD,GAAA,IFgDT,CAAwB,CMRH,INQQ,KAA7B,AMRqB,CJxCZ,UIwCY,CACf,kBAAA,cAAA,CAAK,SADU,EAEf,kBAAA,cAAA,CAAK,GAFU,EAGf,kBAAA,cAAA,CAAK,KAHU,EAIf,kBAAA,cAAA,CAAK,WAJU,EAKf,IALe,CAKV,UAAA,QAAA,EAAQ;ANInB,AKoEA,ADhEJ,AEPU,WFOV,CJJU,MKoED,CLpEQ,KAAK,AKoElB,CAAY,GDhEhB,AEPkB,CNGD,CAAW,CAAC,AKoER,KCvEX,GDuEM,CAAc,CLpES,IKoEnC,EAAiC,CLpER,IKoEzB,CLpE+C,AKoER,ILpEY,IAAJ,GAAW,CKoEnB,MLpEQ,EAAvB,IAA+C,IAA/C,GAAsD,EAAjE,CAAb;AACA,AKmE6C,AD5HjD,AEsDU,CFtDV,EAAA,SJyDU,UAAU,CKmE6B,CAAA,KCtE9B,INGY,IMHrB,CAAkB,KAAlB,ENGU,GAA0B,iBAA1C;AAEA,AKiE8C,AD5HrC,AEuDH,QFvDG,KC4HT,EAAgD,CLjExC,GKiER,CLjEA,AKiEqD,CLjExC,II3DJ,EEuDI,CFvDJ,IC4H4C,ICrExC,SFvDJ,EEuDI,CAAY,ENIe,IMJT,GNIlB,GAAkC,AMJlC,EAA0B,QAA1B,CAAP,GNIO,GAAiD,IAAjD,GAAqD,SAArD,IAA+D,SAAS,CAAT,GAAa,EAAb,GAAkB,GAAjF,IAAoF,GAAjG;AACD,AKiEG,ACrEG,iBATgB,CAAjB,ID8EG,UAAL,GAAkB,KAAlB;ALhEL,AKiEK,ACrEC,sBDqEI,QAAL,CAAc,QAAd,GAAyB,CAAC,MAAK,IAA/B;AL/DN,AKgEM,ACrEA,SNKN,UMLa,CNKb,CAAqB,CKgEV,OLhEX,CKgEM,CLhEiC,AKgEnB,GCrEQ,EDqEtB,ECrEO,CDqEe,ACrEK,EDqE3B,QCrE2B,OAAA,EAAO;ANMtC,AKgEI,ACrEE,QNKA,OAAO,OKgEJ,ELhEa,CMLP,MNKF,CAAiB,EKgE1B,CLhES,AKgES,CLhEY,EML5B,CAAuB,GNKhB,CAAb,AKgEI,GAA6B,ACrE3B,KDqEF;AL/DJ,AKgEI,ACrEE,QNKF,SAAS,IAAb,CKgES,CLhEU,UKgEf,CAAiB,EAAE,ACrEG,KAApB,GDqEyB,MAAK,IAAL,CAAU,aAAV,CAAwB,uBAAxB,CAAV,EAAjB;AL/DF,AKgEE,ACrEC,aAHM,CAAP,CNQK,CAAP,MKgEO,OAAL,CAAa,WAAb,GAA2B,gBAA3B;AL/DH,AKgEE,ACrEA,aD8DD;ALxDF,AKgEC,ACpEC,QNII,CK8CE,MClDC,CNIK,OMJL,KAAA,GAAQ,IAAR,CAAa,YAAA,INI4B,IAApC,CAAyC,IAAzC,CAAd;AACA,AKiEQ,ACtEoB,QNKxB,KKiEI,KLjEM,CMLc,GNK5B,EAAoB,AKiEZ,GAAc,CCtEM,QAAA,CDsEL,CCtEK,CDsEN,EAAkB;ALhEtC,AMNoC,SAA7B,EAA+B,INM/B,AMNA,CNMP,AKgEuB,ACtEoB,SDsEpB,CCtEoB,CAAA,CDsEpB,CCtEqB;ANO7C,AKgEC,ACtEE,gBDsEE,EAAE,CCtEG,CAAP,gBDsEsB,iBAApB,KAA0C,CAAC,OAAO,SAAP,CAAiB,QAAjB,CAA0B,YAA1B,CAA/C,EAAwF;AL/D1F,AKgEI,ACtEA,WNMG,CAAC,MAAM,CAAN,CAAR,CMNa,OAAT,CAAiB,IAAjB;ANOL,AKgEI,ACtEC,gCAAoB,OAApB,CAA4B,IAA5B;ANQN,AK+DI,ACtEC,SNOL,AMXW,CAAP,MD0EI,IL/DR,CAAqB,EK+DN,KL/Df,EAAqC,EK+D7B,CAAiB,QAAjB,CAA0B,UAA1B,CAAJ,EAA2C;AL9D7C,AK+DI,ACtEH,KA5BD,MNmCO,MAAM,OAAN,EAAe,IAAf,CAAoB,UAAA,QAAA,EAAQ;AACjC,AK+DC,ACrEH,QAAM,INMA,SAAS,MAAT,GMNsB,ENMF,EMNM,CNM9B,EAA6B,qBMNC,mBAAJ,CAAwB,IAAxB,EAA8B,MAA9B,CAA5B;ANOI,AK+DF,ACrEF,aAAS,KDqEF,EL/DH,AMNJ,CAAiB,CDqEf,CAAU,EL/DR,CAAM,KAAN,CMNJ,CAA6B,CNMX,EK+DhB,CAAwB,CL/DtB,eMN6C,MDqE/C,CCrEF,CDqEmD,SAAjD,CAA2D,MAA3D,CAAkE,UAAlE;AL9DC,AK+DD,ACrEF,UAAA,SDqES,ICrET,KDqEE,CAAiB,GAAjB,CAAqB,UAArB;AL9DA,AK+DA,ACrEH,YNMO,IK+DE,KL/DO,MAAT,CK+Dc,IL/DM,GAAxB,AK+DyB,EL/DI,OK+DX,CAAiB,QAAjB,CAA0B,aAA1B,CAAlB;AL9DE,AK+DF,ACpEJ,iBAAiB,CDoER,GL/DM,IAAT,CK+DF,CAAc,CL/DI,IAAhB,AK+DF,ACpEJ,CNK2B,AK+DH,CCpEU,MDoE9B,GL/DuB,AK+DO,ACpEA,INKP,EAAI,MK+De,MAAZ,ACpEA,GDoEqB,ACpErB,EDoE9B;AL9DI,AK+DJ,ACpEF,kBDoEO,EL/DG,IMLU,CNKL,AK+Db,CAAa,KAAb,CL/DQ,AK+DW,KL/DM,EK+DzB,ACpEF,EAAqC,CDoEN,YAAY,EAAZ,GAAiB,ACpEhD,MDoEE,YL/DI,EAA+D;AAC7D,AK+DN,ACpEF,aAAS,KDoEP,QCpEF,CNKe,AMLQ,IDoErB,OCpEF,ENKQ,AML6B,CNKR,IAAI,WAAJ,CAAgB,CML7C,CAAwD,YAAxD,CNK6B,CAArB,AML8D,gHAEtB,kBAAA,cAAA,CAAK,KAFiB,GAEZ,GAFY,GAER,kBAAA,cAAA,CAAK,IAFG,GAEC,8RAFvE;ANMO,AK+DN,AC7DF,CAVD,QD0DU;ALjDH,AK9DH,aL0DE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","file":"utterances.afcc63fe.map","sourcesContent":["export function deparam(query: string): { [name: string]: string; } {\n  let match: RegExpExecArray | null;\n  const plus = /\\+/g;\n  const search = /([^&=]+)=?([^&]*)/g;\n  const decode = (s: string) => decodeURIComponent(s.replace(plus, ' '));\n  const params: { [name: string]: string; } = {};\n  // tslint:disable-next-line:no-conditional-assignment\n  while (match = search.exec(query)) {\n    params[decode(match[1])] = decode(match[2]);\n  }\n  return params;\n}\n\nexport function param(obj: any) {\n  const parts = [];\n  for (const name in obj) {\n    if (obj.hasOwnProperty(name)) {\n      parts.push(`${encodeURIComponent(name)}=${encodeURIComponent(obj[name])}`);\n    }\n  }\n  return parts.join('&');\n}\n","export default /^([a-z][\\w-]+)\\/([\\w-.]+)$/i;\n","import { deparam } from './deparam';\nimport repoRegex from './repo-regex';\n\nfunction readPageAttributes() {\n  const params = deparam(location.search.substr(1));\n\n  let issueTerm: string | null = null;\n  let issueNumber: number | null = null;\n  if ('issue-term' in params) {\n    issueTerm = params['issue-term'];\n    if (issueTerm !== undefined) {\n      if (issueTerm === '') {\n        throw new Error('When issue-term is specified, it cannot be blank.');\n      }\n      if (['title', 'url', 'pathname'].indexOf(issueTerm) !== -1) {\n        issueTerm = params[issueTerm];\n      }\n    }\n  } else if ('issue-number' in params) {\n    issueNumber = +params['issue-number'];\n    if (issueNumber.toString(10) !== params['issue-number']) {\n      throw new Error(`issue-number is invalid. \"${params['issue-number']}`);\n    }\n  } else {\n    throw new Error('\"issue-term\" or \"issue-number\" must be specified.');\n  }\n\n  if (!('repo' in params)) {\n    throw new Error('\"repo\" is required.');\n  }\n\n  if (!('origin' in params)) {\n    throw new Error('\"origin\" is required.');\n  }\n\n  const matches = repoRegex.exec(params.repo);\n  if (matches === null) {\n    throw new Error(`Invalid repo: \"${params.repo}\"`);\n  }\n\n  return {\n    owner: matches[1],\n    repo: matches[2],\n    branch: 'branch' in params ? params.branch : 'master',\n    configPath: 'config-path' in params ? params['config-path'] : 'utterances.json',\n    issueTerm,\n    issueNumber,\n    origin: params.origin,\n    url: params.url,\n    title: params.title,\n    description: params.description\n  };\n}\n\nexport const pageAttributes = readPageAttributes();\n","// export const UTTERANCES_API = 'http://localhost:5000';\nexport const UTTERANCES_API = 'https://utterances-oauth2.azurewebsites.net';\n","import { UTTERANCES_API } from './utterances-api';\nimport { param } from './deparam';\n\nconst authorizeUrl = `${UTTERANCES_API}/authorize`;\nconst tokenUrl = `${UTTERANCES_API}/token`;\n// tslint:disable-next-line:variable-name\nconst redirect_uri = `${location.origin}/authorized.html`;\n\nclass Token {\n  private readonly storageKey = 'OAUTH_TOKEN2';\n  private token: string | null = null;\n\n  constructor() {\n    try {\n      this.token = localStorage.getItem(this.storageKey);\n      // tslint:disable-next-line:no-empty\n    } catch (e) { }\n  }\n\n  get value() {\n    return this.token;\n  }\n  set value(newValue) {\n    this.token = newValue;\n    try {\n      if (newValue === null) {\n        localStorage.removeItem(this.storageKey);\n      } else {\n        localStorage.setItem(this.storageKey, newValue);\n      }\n      // tslint:disable-next-line:no-empty\n    } catch (e) { }\n  }\n}\n\nexport const token = new Token();\n\nexport function login() {\n  window.open(`${authorizeUrl}?${param({ redirect_uri })}`);\n  return new Promise(resolve => (window as any).notifyAuthorized = resolve)\n    .then(search => fetch(tokenUrl + search, { mode: 'cors' }))\n    .then(response => {\n      if (response.ok) {\n        return response.json();\n      }\n      return response.text().then(text => Promise.reject(`Error retrieving token:\\n${text}`));\n    })\n    .then(t => { token.value = t; }, reason => { token.value = null; throw reason; });\n}\n","declare function escape(str: string): string;\n\nexport function decodeBase64UTF8(encoded: string) {\n  encoded = encoded.replace(/\\s/g, '');\n  return decodeURIComponent(escape(atob(encoded)));\n}\n","import { token } from './oauth';\nimport { decodeBase64UTF8 } from './encoding';\nimport { UTTERANCES_API } from './utterances-api';\n\nconst GITHUB_API = 'https://api.github.com/';\nconst GITHUB_ENCODING__HTML_JSON = 'application/vnd.github.VERSION.html+json';\nconst GITHUB_ENCODING__HTML = 'application/vnd.github.VERSION.html';\nconst GITHUB_ENCODING__REACTIONS_PREVIEW = 'application/vnd.github.squirrel-girl-preview';\nconst PAGE_SIZE = 100;\n\nlet owner: string;\nlet repo: string;\nlet branch: string;\n\nexport function setRepoContext(context: { owner: string; repo: string; branch: string; }) {\n  owner = context.owner;\n  repo = context.repo;\n  branch = context.branch;\n}\n\nfunction githubRequest(relativeUrl: string, init?: RequestInit) {\n  init = init || {};\n  init.mode = 'cors';\n  init.cache = 'no-cache'; // force conditional request\n  const request = new Request(GITHUB_API + relativeUrl, init);\n  request.headers.set('Accept', GITHUB_ENCODING__REACTIONS_PREVIEW);\n  if (!/^search\\//.test(relativeUrl) && token.value !== null) {\n    request.headers.set('Authorization', `token ${token.value}`);\n  }\n  return request;\n}\n\nconst rateLimit = {\n  standard: {\n    limit: Number.MAX_VALUE,\n    remaining: Number.MAX_VALUE,\n    reset: 0\n  },\n  search: {\n    limit: Number.MAX_VALUE,\n    remaining: Number.MAX_VALUE,\n    reset: 0\n  }\n};\n\nfunction processRateLimit(response: Response) {\n  const limit = response.headers.get('X-RateLimit-Limit') as string;\n  const remaining = response.headers.get('X-RateLimit-Remaining') as string;\n  const reset = response.headers.get('X-RateLimit-Reset') as string;\n\n  const isSearch = /\\/search\\//.test(response.url);\n  const rate = isSearch ? rateLimit.search : rateLimit.standard;\n\n  rate.limit = +limit;\n  rate.remaining = +remaining;\n  rate.reset = +reset;\n\n  if (response.status === 403 && rate.remaining === 0) {\n    const resetDate = new Date(0);\n    resetDate.setUTCSeconds(rate.reset);\n    const mins = Math.round((resetDate.getTime() - new Date().getTime()) / 1000 / 60);\n    const apiType = isSearch ? 'search API' : 'non-search APIs';\n    // tslint:disable-next-line:no-console\n    console.warn(`Rate limit exceeded for ${apiType}. Resets in ${mins} minute${mins === 1 ? '' : 's'}.`);\n  }\n}\n\nfunction readRelNext(response: Response) {\n  const link = response.headers.get('link');\n  if (link === null) {\n    return 0;\n  }\n  const match = /\\?page=([2-9][0-9]*)>; rel=\"next\"/.exec(link);\n  if (match === null) {\n    return 0;\n  }\n  return +match[1];\n}\n\nfunction githubFetch(request: Request): Promise<Response> {\n  return fetch(request).then(response => {\n    if (response.status === 401) {\n      token.value = null;\n    }\n    if (response.status === 403) {\n      response.json().then(data => {\n        if (data.message === 'Resource not accessible by integration') {\n          window.dispatchEvent(new CustomEvent('not-installed'));\n        }\n      });\n    }\n\n    processRateLimit(response);\n\n    if (request.method === 'GET'\n      && [401, 403].indexOf(response.status) !== -1\n      && request.headers.has('Authorization')\n    ) {\n      request.headers.delete('Authorization');\n      return githubFetch(request);\n    }\n    return response;\n  });\n}\n\nexport function loadJsonFile<T>(path: string, html = false) {\n  const request = githubRequest(`repos/${owner}/${repo}/contents/${path}?ref=${branch}`);\n  if (html) {\n    request.headers.set('accept', GITHUB_ENCODING__HTML);\n  }\n  return githubFetch(request).then<FileContentsResponse | string>(response => {\n    if (response.status === 404) {\n      throw new Error(`Repo \"${owner}/${repo}\" does not have a file named \"${path}\" in the \"${branch}\" branch.`);\n    }\n    if (!response.ok) {\n      throw new Error(`Error fetching ${path}.`);\n    }\n    return html ? response.text() : response.json();\n  }).then<T>(file => {\n    if (html) {\n      return file;\n    }\n    const { content } = file as FileContentsResponse;\n    const decoded = decodeBase64UTF8(content);\n    return JSON.parse(decoded);\n  });\n}\n\nexport function loadIssueByTerm(term: string) {\n  const q = `\"${term}\" type:issue in:title repo:${owner}/${repo}`;\n  const request = githubRequest(`search/issues?q=${encodeURIComponent(q)}&sort=created&order=asc`);\n  return githubFetch(request).then<IssueSearchResponse>(response => {\n    if (!response.ok) {\n      throw new Error('Error fetching issue via search.');\n    }\n    return response.json();\n  }).then(results => {\n    if (results.total_count === 0) {\n      return null;\n    }\n    if (results.total_count > 1) {\n      // tslint:disable-next-line:no-console\n      console.warn(`Multiple issues match \"${q}\". Using earliest created.`);\n    }\n    return results.items[0];\n  });\n}\n\nexport function loadIssueByNumber(issueNumber: number) {\n  const request = githubRequest(`repos/${owner}/${repo}/issues/${issueNumber}`);\n  return githubFetch(request).then<Issue>(response => {\n    if (!response.ok) {\n      throw new Error('Error fetching issue via issue number.');\n    }\n    return response.json();\n  });\n}\n\nfunction commentsRequest(issueNumber: number, page: number) {\n  const url = `repos/${owner}/${repo}/issues/${issueNumber}/comments?page=${page}&per_page=${PAGE_SIZE}`;\n  const request = githubRequest(url);\n  const accept = `${GITHUB_ENCODING__HTML_JSON},${GITHUB_ENCODING__REACTIONS_PREVIEW}`;\n  request.headers.set('Accept', accept);\n  return request;\n}\n\nexport function loadCommentsPage(issueNumber: number, page: number) {\n  const request = commentsRequest(issueNumber, page);\n  return githubFetch(request).then(response => {\n    if (!response.ok) {\n      throw new Error('Error fetching comments.');\n    }\n    const nextPage = readRelNext(response);\n    return response.json()\n      .then<CommentsPage>((items: IssueComment[]) => ({ items, nextPage }));\n  });\n}\n\nexport function loadUser(): Promise<User | null> {\n  if (token.value === null) {\n    return Promise.resolve(null);\n  }\n  return githubFetch(githubRequest('user'))\n    .then(response => {\n      if (response.ok) {\n        return response.json();\n      }\n      return null;\n    });\n}\n\nexport function createIssue(issueTerm: string, documentUrl: string, title: string, description: string) {\n  const request = new Request(`${UTTERANCES_API}/repos/${owner}/${repo}/issues`, {\n    method: 'POST',\n    body: JSON.stringify({\n      title: issueTerm,\n      body: `# ${title}\\n\\n${description}\\n\\n[${documentUrl}](${documentUrl})`\n    })\n  });\n  request.headers.set('Accept', GITHUB_ENCODING__REACTIONS_PREVIEW);\n  request.headers.set('Authorization', `token ${token.value}`);\n  return fetch(request).then<Issue>(response => {\n    if (!response.ok) {\n      throw new Error('Error creating comments container issue');\n    }\n    return response.json();\n  });\n}\n\nexport function postComment(issueNumber: number, markdown: string) {\n  const url = `repos/${owner}/${repo}/issues/${issueNumber}/comments`;\n  const body = JSON.stringify({ body: markdown });\n  const request = githubRequest(url, { method: 'POST', body });\n  const accept = `${GITHUB_ENCODING__HTML_JSON},${GITHUB_ENCODING__REACTIONS_PREVIEW}`;\n  request.headers.set('Accept', accept);\n  return githubFetch(request).then<IssueComment>(response => {\n    if (!response.ok) {\n      throw new Error('Error posting comment.');\n    }\n    return response.json();\n  });\n}\n\nexport function renderMarkdown(text: string) {\n  const body = JSON.stringify({ text, mode: 'gfm', context: `${owner}/${repo}` });\n  return githubFetch(githubRequest('markdown', { method: 'POST', body }))\n    .then(response => response.text());\n}\n\ninterface IssueSearchResponse {\n  total_count: number;\n  incomplete_results: boolean;\n  items: Issue[];\n}\n\nexport interface User {\n  login: string;\n  id: number;\n  avatar_url: string;\n  gravatar_id: string;\n  url: string;\n  html_url: string;\n  followers_url: string;\n  following_url: string;\n  gists_url: string;\n  starred_url: string;\n  subscriptions_url: string;\n  organizations_url: string;\n  repos_url: string;\n  events_url: string;\n  received_events_url: string;\n  type: string;\n}\n\nexport type CommentAuthorAssociation =\n  'COLLABORATOR'\n  | 'CONTRIBUTOR'\n  | 'FIRST_TIMER'\n  | 'FIRST_TIME_CONTRIBUTOR'\n  | 'MEMBER'\n  | 'NONE'\n  | 'OWNER';\n\nexport interface Issue {\n  url: string;\n  repository_url: string;\n  labels_url: string;\n  comments_url: string;\n  events_url: string;\n  html_url: string;\n  id: number;\n  number: number;\n  title: string;\n  user: User;\n  locked: boolean;\n  labels: {\n    url: string;\n    name: string;\n    color: string;\n  }[];\n  state: string;\n  assignee: null; // todo,\n  milestone: null; // todo,\n  comments: number;\n  created_at: string;\n  updated_at: string;\n  closed_at: null; // todo,\n  pull_request: {\n    html_url: null; // todo,\n    diff_url: null; // todo,\n    patch_url: null; // todo\n  };\n  body: string;\n  score: number;\n  reactions: {\n    total_count: number;\n    '+1': number;\n    '-1': number;\n    laugh: number;\n    confused: number;\n    heart: number;\n    hooray: number;\n    url: string;\n  };\n  author_association: CommentAuthorAssociation;\n}\n\ninterface FileContentsResponse {\n  type: string;\n  encoding: string;\n  size: number;\n  name: string;\n  path: string;\n  content: string;\n  sha: string;\n  url: string;\n  git_url: string;\n  html_url: string;\n  download_url: string;\n}\n\nexport interface IssueComment {\n  id: number;\n  url: string;\n  html_url: string;\n  body_html: string;\n  user: User;\n  created_at: string;\n  updated_at: string;\n  author_association: CommentAuthorAssociation;\n}\n\nexport interface CommentsPage {\n  items: IssueComment[];\n  nextPage: number;\n}\n\n/*\nquery IssueComments($owner: String!, $repo: String!, $issueQuery: String!) {\n  search(query: $issueQuery, type: ISSUE, first: 1) {\n    issueCount\n    edges {\n      node {\n        ... on Issue {\n          id\n          title,\n          comments(first: 100) {\n          \ttotalCount\n            edges {\n              node {\n                id,\n                createdAt,\n                bodyHTML,\n                author {\n                  avatarUrl,\n                  login\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  rateLimit {\n    cost\n    limit\n    remaining\n    resetAt\n  }\n\n  repository(owner: $owner, name: $repo) {\n    object(expression: \"master:utterances.json\") {\n      ... on Blob {\n        text\n      }\n    }\n  }\n}\n\n{\n  \"issueQuery\": \"user:jdanyow repo:utterances-demo debug\",\n  \"owner\": \"jdanyow\",\n  \"repo\": \"utterances-demo\"\n}\n*/\n","// todo: take a dependency on some relative time library.\n\nconst thresholds = [\n  1000, 'second',\n  1000 * 60, 'minute',\n  1000 * 60 * 60, 'hour',\n  1000 * 60 * 60 * 24, 'day',\n  1000 * 60 * 60 * 24 * 7, 'week',\n  1000 * 60 * 60 * 24 * 27, 'month'\n];\n\nconst formatOptions: Intl.DateTimeFormatOptions = { month: 'short', day: 'numeric', year: 'numeric' };\n\nexport function timeAgo(current: number, value: Date) {\n  const elapsed = current - value.getTime();\n  if (elapsed < 5000) {\n    return 'just now';\n  }\n  let i = 0;\n  while (i + 2 < thresholds.length && elapsed * 1.1 > thresholds[i + 2]) {\n    i += 2;\n  }\n\n  const divisor = thresholds[i] as number;\n  const text = thresholds[i + 1] as string;\n  const units = Math.round(elapsed / divisor);\n\n  if (units > 3 && i === thresholds.length - 2) {\n    return `on ${value.toLocaleDateString(undefined, formatOptions)}`;\n  }\n  return units === 1 ? `${text === 'hour' ? 'an' : 'a'} ${text} ago` : `${units} ${text}s ago`;\n}\n","import { IssueComment } from './github';\nimport { timeAgo } from './time-ago';\n\nconst avatarArgs = '?v=3&s=88';\nconst displayAssociations: { [association: string]: string; } = {\n  COLLABORATOR: 'Collaborator',\n  CONTRIBUTOR: 'Contributor',\n  MEMBER: 'Member',\n  OWNER: 'Owner'\n};\n\nexport class CommentComponent {\n  public readonly element: HTMLElement;\n\n  constructor(\n    public comment: IssueComment,\n    private currentUser: string | null\n  ) {\n    const { user, html_url, created_at, body_html, author_association } = comment;\n    this.element = document.createElement('article');\n    this.element.classList.add('timeline-comment');\n    if (user.login === currentUser) {\n      this.element.classList.add('current-user');\n    }\n    const association = displayAssociations[author_association];\n    this.element.innerHTML = `\n      <a class=\"avatar\" href=\"${user.html_url}\" target=\"_blank\">\n        <img alt=\"@${user.login}\" height=\"44\" width=\"44\"\n              src=\"${user.avatar_url}${avatarArgs}\">\n      </a>\n      <div class=\"comment\">\n        <header class=\"comment-header\">\n          <span class=\"comment-meta\">\n            <a class=\"text-link\" href=\"${user.html_url}\" target=\"_blank\"><strong>${user.login}</strong></a>\n            commented\n            <a class=\"text-link\" href=\"${html_url}\" target=\"_blank\">${timeAgo(Date.now(), new Date(created_at))}</a>\n          </span>\n          ${association ? `<span class=\"author-association-badge\">${association}</span>` : ''}\n        </header>\n        <div class=\"markdown-body markdown-body-scrollable\">\n          ${body_html}\n        </div>\n      </div>`;\n\n    this.retargetLinks();\n  }\n\n  public setCurrentUser(currentUser: string | null) {\n    if (this.currentUser === currentUser) {\n      return;\n    }\n    this.currentUser = currentUser;\n\n    if (this.comment.user.login === this.currentUser) {\n      this.element.classList.add('current-user');\n    } else {\n      this.element.classList.remove('current-user');\n    }\n  }\n\n  private retargetLinks() {\n    const links = this.element.lastElementChild!.lastElementChild!.querySelectorAll('a');\n    let j = links.length;\n    while (j--) {\n      const link = links.item(j);\n      link.target = '_blank';\n    }\n  }\n}\n","export interface ResizeMessage {\n  type: 'resize';\n  height: number;\n}\n\nlet hostOrigin: string;\n\nexport function setHostOrigin(origin: string) {\n  hostOrigin = origin;\n  addEventListener('resize', publishResize);\n}\n\nlet lastHeight = -1;\n\nexport function publishResize() {\n  const height = document.body.scrollHeight;\n  if (height === lastHeight) {\n    return;\n  }\n  lastHeight = height;\n  const message: ResizeMessage = { type: 'resize', height };\n  parent.postMessage(message, hostOrigin);\n}\n","import { User, Issue, IssueComment } from './github';\nimport { CommentComponent } from './comment-component';\nimport { publishResize } from './bus';\n\nexport class TimelineComponent {\n  public readonly element: HTMLElement;\n  private readonly timeline: CommentComponent[] = [];\n  private readonly countAnchor: HTMLAnchorElement;\n  private readonly marker: Node;\n  private count: number = 0;\n\n  constructor(\n    private user: User | null,\n    private issue: Issue | null\n  ) {\n    this.element = document.createElement('section');\n    this.element.classList.add('timeline');\n    this.element.innerHTML = `\n      <h1 class=\"timeline-header\">\n        <a class=\"text-link\" target=\"_blank\"></a>\n        <em>\n          - powered by\n          <a class=\"text-link\" href=\"https://utteranc.es\" target=\"_blank\">utteranc.es</a>\n        </em>\n      </h1>`;\n    this.countAnchor = this.element.firstElementChild!.firstElementChild as HTMLAnchorElement;\n    this.marker = document.createComment('marker');\n    this.element.appendChild(this.marker);\n    this.setIssue(this.issue);\n    this.renderCount();\n  }\n\n  public setUser(user: User | null) {\n    this.user = user;\n    const login = user ? user.login : null;\n    for (let i = 0; i < this.timeline.length; i++) {\n      this.timeline[i].setCurrentUser(login);\n    }\n    publishResize();\n  }\n\n  public setIssue(issue: Issue | null) {\n    this.issue = issue;\n    if (issue) {\n      this.countAnchor.href = issue.html_url;\n    } else {\n      this.countAnchor.removeAttribute('href');\n    }\n  }\n\n  public appendComment(comment: IssueComment) {\n    const component = new CommentComponent(\n      comment,\n      this.user ? this.user.login : null);\n    this.timeline.push(component);\n    this.element.insertBefore(component.element, this.marker);\n    this.count++;\n    this.renderCount();\n    publishResize();\n  }\n\n  private renderCount() {\n    this.countAnchor.textContent = `${this.count} Comment${this.count === 1 ? '' : 's'}`;\n  }\n}\n","import { User, renderMarkdown } from './github';\nimport { publishResize } from './bus';\n\n// tslint:disable-next-line:max-line-length\nconst anonymousAvatar = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14 16\" version=\"1.1\"><path fill=\"rgb(179,179,179)\" fill-rule=\"evenodd\" d=\"M8 10.5L9 14H5l1-3.5L5.25 9h3.5L8 10.5zM10 6H4L2 7h10l-2-1zM9 2L7 3 5 2 4 5h6L9 2zm4.03 7.75L10 9l1 2-2 3h3.22c.45 0 .86-.31.97-.75l.56-2.28c.14-.53-.19-1.08-.72-1.22zM4 9l-3.03.75c-.53.14-.86.69-.72 1.22l.56 2.28c.11.44.52.75.97.75H5l-2-3 1-2z\"></path></svg>`;\n// base64 encoding works in IE, Edge. UTF-8 does not.\nconst anonymousAvatarUrl = `data:image/svg+xml;base64,${btoa(anonymousAvatar)}`;\n\nconst nothingToPreview = 'Nothing to preview';\n\nexport class NewCommentComponent {\n  public readonly element: HTMLElement;\n\n  private avatarAnchor: HTMLAnchorElement;\n  private avatar: HTMLImageElement;\n  private form: HTMLFormElement;\n  private textarea: HTMLTextAreaElement;\n  private preview: HTMLDivElement;\n  private submitButton: HTMLButtonElement;\n\n  private submitting = false;\n  private renderTimeout = 0;\n\n  constructor(\n    private user: User | null,\n    private readonly submit: (markdown: string) => Promise<void>\n  ) {\n    this.element = document.createElement('article');\n    this.element.classList.add('timeline-comment');\n    this.element.addEventListener('mousemove', publishResize); // todo: measure, throttle\n\n    this.element.innerHTML = `\n      <a class=\"avatar\" target=\"_blank\">\n        <img height=\"44\" width=\"44\">\n      </a>\n      <form class=\"comment\" accept-charset=\"UTF-8\" action=\"javascript:\">\n        <header class=\"new-comment-header\">\n          <nav class=\"tabnav-tabs\" role=\"tablist\">\n            <button type=\"button\" class=\"tabnav-tab tab-write selected\"\n                    role=\"tab\" aria-selected=\"true\">\n              Write\n            </button>\n            <button type=\"button\" class=\"tabnav-tab tab-preview\"\n                    role=\"tab\">\n              Preview\n            </button>\n          </nav>\n        </header>\n        <div class=\"comment-body\">\n          <textarea placeholder=\"Leave a comment\" aria-label=\"comment\"></textarea>\n          <div class=\"markdown-body\" style=\"display: none\">\n            ${nothingToPreview}\n          </div>\n        </div>\n        <footer class=\"comment-footer\">\n          <a class=\"text-link markdown-info\" tabindex=\"-1\" target=\"_blank\"\n             href=\"https://guides.github.com/features/mastering-markdown/\">\n            Styling with Markdown is supported\n          </a>\n          <button class=\"btn btn-primary\" type=\"submit\">Comment</button>\n        </footer>\n      </form>`;\n\n    this.avatarAnchor = this.element.firstElementChild as HTMLAnchorElement;\n    this.avatar = this.avatarAnchor.firstElementChild as HTMLImageElement;\n    this.form = this.avatarAnchor.nextElementSibling as HTMLFormElement;\n    this.textarea = this.form!.firstElementChild!.nextElementSibling!.firstElementChild as HTMLTextAreaElement;\n    this.preview = this.form!.firstElementChild!.nextElementSibling!.lastElementChild as HTMLDivElement;\n    this.submitButton = this.form!.lastElementChild!.lastElementChild as HTMLButtonElement;\n\n    this.setUser(user);\n\n    this.textarea.addEventListener('input', this.handleInput);\n    this.form.addEventListener('submit', this.handleSubmit);\n    this.form.addEventListener('click', this.handleClick);\n  }\n\n  public setUser(user: User | null) {\n    this.user = user;\n    this.submitButton.textContent = user ? 'Comment' : 'Sign in to comment';\n    this.submitButton.disabled = !!user;\n\n    if (user) {\n      this.avatarAnchor.href = user.html_url;\n      this.avatar.alt = '@' + user.login;\n      this.avatar.src = user.avatar_url + '?v=3&s=88';\n    } else {\n      this.avatarAnchor.removeAttribute('href');\n      this.avatar.alt = '@anonymous';\n      this.avatar.src = anonymousAvatarUrl;\n      this.textarea.disabled = true;\n    }\n  }\n\n  public clear() {\n    this.textarea.value = '';\n  }\n\n  private handleInput = () => {\n    const text = this.textarea.value;\n    const isWhitespace = /^\\s*$/.test(text);\n    this.submitButton.disabled = isWhitespace;\n    if (this.textarea.scrollHeight < 450 && this.textarea.offsetHeight < this.textarea.scrollHeight) {\n      this.textarea.style.height = `${this.textarea.scrollHeight}px`;\n      publishResize();\n    }\n\n    clearTimeout(this.renderTimeout);\n    if (isWhitespace) {\n      this.preview.textContent = nothingToPreview;\n    } else {\n      this.preview.textContent = 'Loading preview...';\n      this.renderTimeout = setTimeout(\n        () => renderMarkdown(text).then(html => this.preview.innerHTML = html).then(publishResize),\n        500);\n    }\n  }\n\n  private handleSubmit = (event: Event) => {\n    event.preventDefault();\n    if (this.submitting) {\n      return;\n    }\n    this.submitting = true;\n    if (this.user) {\n      this.textarea.disabled = true;\n      this.submitButton.disabled = true;\n    }\n    this.submit(this.textarea.value).catch(() => 0).then(() => {\n      this.submitting = false;\n      this.textarea.disabled = !this.user;\n      this.textarea.value = '';\n      this.submitButton.disabled = false;\n      this.handleClick({ target: this.form.querySelector('.tabnav-tab.tab-write') } as any);\n      this.preview.textContent = nothingToPreview;\n    });\n  }\n\n  private handleClick = ({ target }: Event) => {\n    if (!(target instanceof HTMLButtonElement) || !target.classList.contains('tabnav-tab')) {\n      return;\n    }\n    if (target.classList.contains('selected')) {\n      return;\n    }\n    this.form.querySelector('.tabnav-tab.selected')!.classList.remove('selected');\n    target.classList.add('selected');\n    const isPreview = target.classList.contains('tab-preview');\n    this.textarea.style.display = isPreview ? 'none' : '';\n    this.preview.style.display = isPreview ? '' : 'none';\n    publishResize();\n  }\n}\n","import { pageAttributes as page } from './page-attributes';\nimport {\n  Issue,\n  IssueComment,\n  User,\n  setRepoContext,\n  loadIssueByTerm,\n  loadIssueByNumber,\n  loadCommentsPage,\n  loadUser,\n  postComment,\n  createIssue\n} from './github';\nimport { login } from './oauth';\nimport { TimelineComponent } from './timeline-component';\nimport { NewCommentComponent } from './new-comment-component';\nimport { setHostOrigin, publishResize } from './bus';\n\nsetRepoContext(page);\n\nfunction loadIssue(): Promise<Issue | null> {\n  if (page.issueNumber !== null) {\n    return loadIssueByNumber(page.issueNumber);\n  }\n  return loadIssueByTerm(page.issueTerm as string);\n}\n\nPromise.all([loadIssue(), loadUser()])\n  .then(([issue, user]) => bootstrap(issue, user));\n\nfunction bootstrap(issue: Issue | null, user: User | null) {\n  setHostOrigin(page.origin);\n\n  const timeline = new TimelineComponent(user, issue);\n  document.body.appendChild(timeline.element);\n\n  if (issue && issue.comments > 0) {\n    loadCommentsPage(issue.number, 1)\n      .then(({ items }) => items.forEach(comment => timeline.appendComment(comment)));\n  }\n\n  if (issue && issue.locked) {\n    return;\n  }\n\n  const submit = (markdown: string) => {\n    if (user) {\n      let commentPromise: Promise<IssueComment>;\n      if (issue) {\n        commentPromise = postComment(issue.number, markdown);\n      } else {\n        commentPromise = createIssue(\n          page.issueTerm as string,\n          page.url,\n          page.title,\n          page.description\n        ).then(newIssue => {\n          issue = newIssue;\n          timeline.setIssue(issue);\n          return postComment(issue.number, markdown);\n        });\n      }\n      return commentPromise.then(comment => {\n        timeline.appendComment(comment);\n        newCommentComponent.clear();\n      });\n    }\n\n    return login().then(() => loadUser()).then(u => {\n      user = u;\n      timeline.setUser(user);\n      newCommentComponent.setUser(user);\n    });\n  };\n\n  const newCommentComponent = new NewCommentComponent(user, submit);\n  timeline.element.appendChild(newCommentComponent.element);\n  publishResize();\n}\n\naddEventListener('not-installed', function handleNotInstalled() {\n  removeEventListener('not-installed', handleNotInstalled);\n  document.querySelector('.timeline')!.insertAdjacentHTML('afterbegin', `\n  <div class=\"flash flash-error flash-not-installed\">\n    Error: utterances is not installed on <code>${page.owner}/${page.repo}</code>.\n    If you own this repo,\n    <a href=\"https://github.com/apps/utterances\" target=\"_blank\"><strong>install the app</strong></a>.\n    Read more about this change in\n    <a href=\"https://github.com/utterance/utterances/pull/25\" target=\"_blank\">the PR</a>.\n  </div>`);\n});\n"]}