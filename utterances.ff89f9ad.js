parcelRequire=function(e,r,n){var t="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(n,o){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!o&&f)return f(n,!0);if(t)return t(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}a.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,a,l,l.exports)}return r[n].exports;function a(e){return u(a.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=t;for(var o=0;o<n.length;o++)u(n[o]);return u}({44:[function(require,module,exports) {
"use strict";function e(e){for(var r,n=/\+/g,o=/([^&=]+)=?([^&]*)/g,t=function(e){return decodeURIComponent(e.replace(n," "))},p={};r=o.exec(e);)p[t(r[1])]=t(r[2]);return p}function r(e){var r=[];for(var n in e)e.hasOwnProperty(n)&&r.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return r.join("&")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deparam=e,exports.param=r;
},{}],51:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=/^([a-z][\w-]+)\/([\w-.]+)$/i;
},{}],45:[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("./deparam"),i=e(require("./repo-regex"));function n(){var e=r.deparam(location.search.substr(1)),n=null,t=null;if("issue-term"in e){if(void 0!==(n=e["issue-term"])){if(""===n)throw new Error("When issue-term is specified, it cannot be blank.");-1!==["title","url","pathname"].indexOf(n)&&(n=e[n])}}else{if(!("issue-number"in e))throw new Error('"issue-term" or "issue-number" must be specified.');if((t=+e["issue-number"]).toString(10)!==e["issue-number"])throw new Error('issue-number is invalid. "'+e["issue-number"])}if(!("repo"in e))throw new Error('"repo" is required.');if(!("origin"in e))throw new Error('"origin" is required.');var s=i.default.exec(e.repo);if(null===s)throw new Error('Invalid repo: "'+e.repo+'"');return{owner:s[1],repo:s[2],branch:"branch"in e?e.branch:"master",configPath:"config-path"in e?e["config-path"]:"utterances.json",issueTerm:n,issueNumber:t,origin:e.origin,url:e.url,title:e.title,description:e.description}}exports.pageAttributes=n();
},{"./deparam":44,"./repo-regex":51}],52:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UTTERANCES_API="https://utterances-oauth2.azurewebsites.net";
},{}],47:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./utterances-api"),t=require("./deparam"),n=e.UTTERANCES_API+"/authorize",r=e.UTTERANCES_API+"/token",o=location.origin+"/authorized.html",i=function(){function e(){this.storageKey="OAUTH_TOKEN2",this.token=null;try{this.token=localStorage.getItem(this.storageKey)}catch(e){}}return Object.defineProperty(e.prototype,"value",{get:function(){return this.token},set:function(e){this.token=e;try{null===e?localStorage.removeItem(this.storageKey):localStorage.setItem(this.storageKey,e)}catch(e){}},enumerable:!0,configurable:!0}),e}();function u(){return window.open(n+"?"+t.param({redirect_uri:o})),new Promise(function(e){return window.notifyAuthorized=e}).then(function(e){return fetch(r+e,{mode:"cors"})}).then(function(e){return e.ok?e.json():e.text().then(function(e){return Promise.reject("Error retrieving token:\n"+e)})}).then(function(e){exports.token.value=e},function(e){throw exports.token.value=null,e})}exports.token=new i,exports.login=u;
},{"./utterances-api":52,"./deparam":44}],54:[function(require,module,exports) {
"use strict";function e(e){return e=e.replace(/\s/g,""),decodeURIComponent(escape(atob(e)))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeBase64UTF8=e;
},{}],46:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t,n,r=require("./oauth"),o=require("./encoding"),s=require("./utterances-api"),i="https://api.github.com/",a="application/vnd.github.VERSION.html+json",u="application/vnd.github.VERSION.html",c="application/vnd.github.squirrel-girl-preview",h=100;function d(r){e=r.owner,t=r.repo,n=r.branch}function l(e,t){(t=t||{}).mode="cors",t.cache="no-cache";var n=new Request(i+e,t);return n.headers.set("Accept",c),/^search\//.test(e)||null===r.token.value||n.headers.set("Authorization","token "+r.token.value),n}exports.setRepoContext=d;var m={standard:{limit:Number.MAX_VALUE,remaining:Number.MAX_VALUE,reset:0},search:{limit:Number.MAX_VALUE,remaining:Number.MAX_VALUE,reset:0}};function f(e){var t=e.headers.get("X-RateLimit-Limit"),n=e.headers.get("X-RateLimit-Remaining"),r=e.headers.get("X-RateLimit-Reset"),o=/\/search\//.test(e.url),s=o?m.search:m.standard;if(s.limit=+t,s.remaining=+n,s.reset=+r,403===e.status&&0===s.remaining){var i=new Date(0);i.setUTCSeconds(s.reset);var a=Math.round((i.getTime()-(new Date).getTime())/1e3/60),u=o?"search API":"non-search APIs";console.warn("Rate limit exceeded for "+u+". Resets in "+a+" minute"+(1===a?"":"s")+".")}}function p(e){var t=e.headers.get("link");if(null===t)return 0;var n=/\?page=([2-9][0-9]*)>; rel="next"/.exec(t);return null===n?0:+n[1]}function g(e){return fetch(e).then(function(t){return 401===t.status&&(r.token.value=null),403===t.status&&t.json().then(function(e){"Resource not accessible by integration"===e.message&&window.dispatchEvent(new CustomEvent("not-installed"))}),f(t),"GET"===e.method&&-1!==[401,403].indexOf(t.status)&&e.headers.has("Authorization")?(e.headers.delete("Authorization"),g(e)):t})}function v(r,s){void 0===s&&(s=!1);var i=l("repos/"+e+"/"+t+"/contents/"+r+"?ref="+n);return s&&i.headers.set("accept",u),g(i).then(function(o){if(404===o.status)throw new Error('Repo "'+e+"/"+t+'" does not have a file named "'+r+'" in the "'+n+'" branch.');if(!o.ok)throw new Error("Error fetching "+r+".");return s?o.text():o.json()}).then(function(e){if(s)return e;var t=e.content,n=o.decodeBase64UTF8(t);return JSON.parse(n)})}function w(n){var r='"'+n+'" type:issue in:title repo:'+e+"/"+t;return g(l("search/issues?q="+encodeURIComponent(r)+"&sort=created&order=asc")).then(function(e){if(!e.ok)throw new Error("Error fetching issue via search.");return e.json()}).then(function(e){return 0===e.total_count?null:(e.total_count>1&&console.warn('Multiple issues match "'+r+'". Using earliest created.'),e.items[0])})}function E(n){return g(l("repos/"+e+"/"+t+"/issues/"+n)).then(function(e){if(!e.ok)throw new Error("Error fetching issue via issue number.");return e.json()})}function b(n,r){var o=l("repos/"+e+"/"+t+"/issues/"+n+"/comments?page="+r+"&per_page="+h),s=a+","+c;return o.headers.set("Accept",s),o}function x(e,t){return g(b(e,t)).then(function(e){if(!e.ok)throw new Error("Error fetching comments.");var t=p(e);return e.json().then(function(e){return{items:e,nextPage:t}})})}function A(){return null===r.token.value?Promise.resolve(null):g(l("user")).then(function(e){return e.ok?e.json():null})}function k(n,o,i,a){var u=new Request(s.UTTERANCES_API+"/repos/"+e+"/"+t+"/issues",{method:"POST",body:JSON.stringify({title:n,body:"# "+i+"\n\n"+a+"\n\n["+o+"]("+o+")"})});return u.headers.set("Accept",c),u.headers.set("Authorization","token "+r.token.value),fetch(u).then(function(e){if(!e.ok)throw new Error("Error creating comments container issue");return e.json()})}function R(n,r){var o=l("repos/"+e+"/"+t+"/issues/"+n+"/comments",{method:"POST",body:JSON.stringify({body:r})}),s=a+","+c;return o.headers.set("Accept",s),g(o).then(function(e){if(!e.ok)throw new Error("Error posting comment.");return e.json()})}function y(n){return g(l("markdown",{method:"POST",body:JSON.stringify({text:n,mode:"gfm",context:e+"/"+t})})).then(function(e){return e.text()})}exports.loadJsonFile=v,exports.loadIssueByTerm=w,exports.loadIssueByNumber=E,exports.loadCommentsPage=x,exports.loadUser=A,exports.createIssue=k,exports.postComment=R,exports.renderMarkdown=y;
},{"./oauth":47,"./encoding":54,"./utterances-api":52}],55:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=[1e3,"second",6e4,"minute",36e5,"hour",864e5,"day",6048e5,"week",23328e5,"month"],r={month:"short",day:"numeric",year:"numeric"};function t(t,o){var n=t-o.getTime();if(n<5e3)return"just now";for(var a=0;a+2<e.length&&1.1*n>e[a+2];)a+=2;var u=e[a],i=e[a+1],s=Math.round(n/u);return s>3&&a===e.length-2?"on "+o.toLocaleDateString(void 0,r):1===s?("hour"===i?"an":"a")+" "+i+" ago":s+" "+i+"s ago"}exports.timeAgo=t;
},{}],50:[function(require,module,exports) {
"use strict";var e;function t(t){e=t,addEventListener("resize",n),addEventListener("load",n)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.startMeasuring=t;var r=-1;function s(){var t=document.body.scrollHeight;if(t!==r){r=t;var s={type:"resize",height:t};parent.postMessage(s,e)}}var a=0;function n(){var e=Date.now();e-a>50&&(a=e,setTimeout(s,50))}exports.scheduleMeasure=n;
},{}],53:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./time-ago"),t=require("./measure"),r="?v=3&s=88",n={COLLABORATOR:"Collaborator",CONTRIBUTOR:"Contributor",MEMBER:"Member",OWNER:"Owner"},a=function(){function t(t,a){this.comment=t,this.currentUser=a;var l=t.user,o=t.html_url,i=t.created_at,c=t.body_html,m=t.author_association;this.element=document.createElement("article"),this.element.classList.add("timeline-comment"),l.login===a&&this.element.classList.add("current-user");var u=n[m];this.element.innerHTML='\n      <a class="avatar" href="'+l.html_url+'" target="_blank" tabindex="-1">\n        <img alt="@'+l.login+'" height="44" width="44"\n              src="'+l.avatar_url+r+'">\n      </a>\n      <div class="comment">\n        <header class="comment-header">\n          <span class="comment-meta">\n            <a class="text-link" href="'+l.html_url+'" target="_blank"><strong>'+l.login+'</strong></a>\n            commented\n            <a class="text-link" href="'+o+'" target="_blank">'+e.timeAgo(Date.now(),new Date(i))+"</a>\n          </span>\n          "+(u?'<span class="author-association-badge">'+u+"</span>":"")+'\n        </header>\n        <div class="markdown-body markdown-body-scrollable">\n          '+c+"\n        </div>\n      </div>",s(this.element.lastElementChild.lastElementChild)}return t.prototype.setCurrentUser=function(e){this.currentUser!==e&&(this.currentUser=e,this.comment.user.login===this.currentUser?this.element.classList.add("current-user"):this.element.classList.remove("current-user"))},t}();function s(e){Array.from(e.querySelectorAll("a")).forEach(function(e){return e.target="_blank"}),Array.from(e.querySelectorAll("img")).forEach(function(e){return e.onload=t.scheduleMeasure})}exports.CommentComponent=a,exports.processRenderedMarkdown=s;
},{"./time-ago":55,"./measure":50}],48:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./comment-component"),t=require("./measure"),n=function(){function n(e,t){this.user=e,this.issue=t,this.timeline=[],this.count=0,this.element=document.createElement("section"),this.element.classList.add("timeline"),this.element.innerHTML='\n      <h1 class="timeline-header">\n        <a class="text-link" target="_blank"></a>\n        <em>\n          - powered by\n          <a class="text-link" href="https://utteranc.es" target="_blank">utteranc.es</a>\n        </em>\n      </h1>',this.countAnchor=this.element.firstElementChild.firstElementChild,this.marker=document.createComment("marker"),this.element.appendChild(this.marker),this.setIssue(this.issue),this.renderCount()}return n.prototype.setUser=function(e){this.user=e;for(var n=e?e.login:null,s=0;s<this.timeline.length;s++)this.timeline[s].setCurrentUser(n);t.scheduleMeasure()},n.prototype.setIssue=function(e){this.issue=e,e?this.countAnchor.href=e.html_url:this.countAnchor.removeAttribute("href")},n.prototype.appendComment=function(n){var s=new e.CommentComponent(n,this.user?this.user.login:null);this.timeline.push(s),this.element.insertBefore(s.element,this.marker),this.count++,this.renderCount(),t.scheduleMeasure()},n.prototype.renderCount=function(){this.countAnchor.textContent=this.count+" Comment"+(1===this.count?"":"s")},n}();exports.TimelineComponent=n;
},{"./comment-component":53,"./measure":50}],49:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./github"),e=require("./measure"),n=require("./comment-component"),a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 16" version="1.1"><path fill="rgb(179,179,179)" fill-rule="evenodd" d="M8 10.5L9 14H5l1-3.5L5.25 9h3.5L8 10.5zM10 6H4L2 7h10l-2-1zM9 2L7 3 5 2 4 5h6L9 2zm4.03 7.75L10 9l1 2-2 3h3.22c.45 0 .86-.31.97-.75l.56-2.28c.14-.53-.19-1.08-.72-1.22zM4 9l-3.03.75c-.53.14-.86.69-.72 1.22l.56 2.28c.11.44.52.75.97.75H5l-2-3 1-2z"></path></svg>',i="data:image/svg+xml;base64,"+btoa(a),s="Nothing to preview",r=function(){function a(a,i){var r=this;this.user=a,this.submit=i,this.submitting=!1,this.renderTimeout=0,this.handleInput=function(){var a=r.textarea.value,i=/^\s*$/.test(a);r.submitButton.disabled=i,r.textarea.scrollHeight<450&&r.textarea.offsetHeight<r.textarea.scrollHeight&&(r.textarea.style.height=r.textarea.scrollHeight+"px",e.scheduleMeasure()),clearTimeout(r.renderTimeout),i?r.preview.textContent=s:(r.preview.textContent="Loading preview...",r.renderTimeout=setTimeout(function(){return t.renderMarkdown(a).then(function(t){return r.preview.innerHTML=t}).then(function(){return n.processRenderedMarkdown(r.preview)}).then(e.scheduleMeasure)},500))},this.handleSubmit=function(t){t.preventDefault(),r.submitting||(r.submitting=!0,r.user&&(r.textarea.disabled=!0,r.submitButton.disabled=!0),r.submit(r.textarea.value).catch(function(){return 0}).then(function(){r.submitting=!1,r.textarea.disabled=!r.user,r.textarea.value="",r.submitButton.disabled=!1,r.handleClick({target:r.form.querySelector(".tabnav-tab.tab-write")}),r.preview.textContent=s}))},this.handleClick=function(t){var n=t.target;if(n instanceof HTMLButtonElement&&n.classList.contains("tabnav-tab")&&!n.classList.contains("selected")){r.form.querySelector(".tabnav-tab.selected").classList.remove("selected"),n.classList.add("selected");var a=n.classList.contains("tab-preview");r.textarea.style.display=a?"none":"",r.preview.style.display=a?"":"none",e.scheduleMeasure()}},this.element=document.createElement("article"),this.element.classList.add("timeline-comment"),this.element.innerHTML='\n      <a class="avatar" target="_blank" tabindex="-1">\n        <img height="44" width="44">\n      </a>\n      <form class="comment" accept-charset="UTF-8" action="javascript:">\n        <header class="new-comment-header">\n          <nav class="tabnav-tabs" role="tablist">\n            <button type="button" class="tabnav-tab tab-write selected"\n                    role="tab" aria-selected="true">\n              Write\n            </button>\n            <button type="button" class="tabnav-tab tab-preview"\n                    role="tab">\n              Preview\n            </button>\n          </nav>\n        </header>\n        <div class="comment-body">\n          <textarea placeholder="Leave a comment" aria-label="comment"></textarea>\n          <div class="markdown-body" style="display: none">\n            '+s+'\n          </div>\n        </div>\n        <footer class="comment-footer">\n          <a class="text-link markdown-info" tabindex="-1" target="_blank"\n             href="https://guides.github.com/features/mastering-markdown/">\n            Styling with Markdown is supported\n          </a>\n          <button class="btn btn-primary" type="submit">Comment</button>\n        </footer>\n      </form>',this.avatarAnchor=this.element.firstElementChild,this.avatar=this.avatarAnchor.firstElementChild,this.form=this.avatarAnchor.nextElementSibling,this.textarea=this.form.firstElementChild.nextElementSibling.firstElementChild,this.preview=this.form.firstElementChild.nextElementSibling.lastElementChild,this.submitButton=this.form.lastElementChild.lastElementChild,this.setUser(a),this.textarea.addEventListener("input",this.handleInput),this.form.addEventListener("submit",this.handleSubmit),this.form.addEventListener("click",this.handleClick),o(this.textarea)}return a.prototype.setUser=function(t){this.user=t,this.submitButton.textContent=t?"Comment":"Sign in to comment",this.submitButton.disabled=!!t,t?(this.avatarAnchor.href=t.html_url,this.avatar.alt="@"+t.login,this.avatar.src=t.avatar_url+"?v=3&s=88"):(this.avatarAnchor.removeAttribute("href"),this.avatar.alt="@anonymous",this.avatar.src=i,this.textarea.disabled=!0)},a.prototype.clear=function(){this.textarea.value=""},a}();function o(t){var n=function t(){removeEventListener("mousemove",e.scheduleMeasure),removeEventListener("mouseup",t)};t.addEventListener("mousedown",function(){addEventListener("mousemove",e.scheduleMeasure),addEventListener("mouseup",n)})}exports.NewCommentComponent=r;
},{"./github":46,"./measure":50,"./comment-component":53}],42:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./page-attributes"),t=require("./github"),n=require("./oauth"),r=require("./timeline-component"),s=require("./new-comment-component"),u=require("./measure");function i(){return null!==e.pageAttributes.issueNumber?t.loadIssueByNumber(e.pageAttributes.issueNumber):t.loadIssueByTerm(e.pageAttributes.issueTerm)}function o(i,o){u.startMeasuring(e.pageAttributes.origin);var a=new r.TimelineComponent(o,i);if(document.body.appendChild(a.element),i&&i.comments>0&&t.loadCommentsPage(i.number,1).then(function(e){return e.items.forEach(function(e){return a.appendComment(e)})}),!i||!i.locked){var l=new s.NewCommentComponent(o,function(r){if(o)return(i?t.postComment(i.number,r):t.createIssue(e.pageAttributes.issueTerm,e.pageAttributes.url,e.pageAttributes.title,e.pageAttributes.description).then(function(e){return i=e,a.setIssue(i),t.postComment(i.number,r)})).then(function(e){a.appendComment(e),l.clear()});return n.login().then(function(){return t.loadUser()}).then(function(e){o=e,a.setUser(o),l.setUser(o)})});a.element.appendChild(l.element),u.scheduleMeasure()}}t.setRepoContext(e.pageAttributes),Promise.all([i(),t.loadUser()]).then(function(e){return o(e[0],e[1])}),addEventListener("not-installed",function t(){removeEventListener("not-installed",t),document.querySelector(".timeline").insertAdjacentHTML("afterbegin",'\n  <div class="flash flash-error flash-not-installed">\n    Error: utterances is not installed on <code>'+e.pageAttributes.owner+"/"+e.pageAttributes.repo+'</code>.\n    If you own this repo,\n    <a href="https://github.com/apps/utterances" target="_blank"><strong>install the app</strong></a>.\n    Read more about this change in\n    <a href="https://github.com/utterance/utterances/pull/25" target="_blank">the PR</a>.\n  </div>')});
},{"./page-attributes":45,"./github":46,"./oauth":47,"./timeline-component":48,"./new-comment-component":49,"./measure":50}]},{},[42])
//# sourceMappingURL=/utterances.ff89f9ad.map